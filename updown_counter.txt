library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.NUMERIC_STD.ALL;

entity updown_counter is
    Port (
        i_clk   : in  STD_LOGIC;
        i_reset : in  STD_LOGIC;
        o_count : out STD_LOGIC_VECTOR(3 downto 0)
    );
end updown_counter;

architecture Behavioral of updown_counter is
    signal cnt : unsigned(3 downto 0) := (others => '0');
    signal dir : std_logic := '1'; 
    constant MAX_COUNT : unsigned(3 downto 0) := "1000";

begin
    
    DIR_CONTROL: process(i_clk, i_reset)
    begin
        if i_reset = '1' then
            dir <= '1';
            
        elsif rising_edge(i_clk) then
            if (dir = '1' and cnt = MAX_COUNT) then
                dir <= '0';
            elsif (dir = '0' and cnt = 1) then
                dir <= '1';
            end if;
        end if;
    end process DIR_CONTROL;
    
    CNT_CONTROL: process(i_clk, i_reset)
    begin
        if i_reset = '1' then
            cnt <= (others => '0');
            
        elsif rising_edge(i_clk) then
 
        if dir = '1' then
            cnt <= cnt + 1; 
        else 
            cnt <= cnt - 1; 
    end if;
end if;
    end process CNT_CONTROL;
    
    process(cnt)
    begin
        o_count <= std_logic_vector(cnt);
        end process;
end Behavioral;